"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTodosByYearAndTitle = void 0;
const dynamodb_1 = require("aws-sdk/clients/dynamodb");
const docClient = new dynamodb_1.DocumentClient({ apiVersion: '2012-08-10' });
const getTodosByYearAndTitle = async (input) => {
    const { year, title } = input;
    const params = {
        TableName: process.env.TODOS_TABLE,
        IndexName: process.env.TODOS_TITLE_YEAR_INDEX,
        KeyConditionExpression: '#year = :year and begins_with(#title, :title)',
        ExpressionAttributeNames: {
            "#title": "title",
            "#year": 'year'
        },
        ExpressionAttributeValues: {
            ':title': title,
            ':year': year
        }
    };
    try {
        const { Items } = await docClient.query(params).promise();
        return Items;
    }
    catch (err) {
        console.log('DynamoDB error: ', err);
        return null;
    }
};
exports.getTodosByYearAndTitle = getTodosByYearAndTitle;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0VG9kb3NCeVllYXJBbmRUaXRsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImdldFRvZG9zQnlZZWFyQW5kVGl0bGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsdURBQTBEO0FBQzFELE1BQU0sU0FBUyxHQUFHLElBQUkseUJBQWMsQ0FBQyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsQ0FBQyxDQUFDO0FBRzVELE1BQU0sc0JBQXNCLEdBQUcsS0FBSyxFQUFFLEtBQStCLEVBQUUsRUFBRTtJQUM1RSxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxHQUFHLEtBQUssQ0FBQztJQUM5QixNQUFNLE1BQU0sR0FBOEI7UUFDdEMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBWTtRQUNuQyxTQUFTLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQkFBdUI7UUFDOUMsc0JBQXNCLEVBQUUsK0NBQStDO1FBQ3ZFLHdCQUF3QixFQUFFO1lBQ3RCLFFBQVEsRUFBRSxPQUFPO1lBQ2pCLE9BQU8sRUFBRSxNQUFNO1NBQ2xCO1FBQ0QseUJBQXlCLEVBQUU7WUFDdkIsUUFBUSxFQUFFLEtBQUs7WUFDZixPQUFPLEVBQUUsSUFBSTtTQUNoQjtLQUNKLENBQUE7SUFDRCxJQUFJO1FBQ0EsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLE1BQU0sU0FBUyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtRQUN6RCxPQUFPLEtBQUssQ0FBQTtLQUNmO0lBQUMsT0FBTyxHQUFHLEVBQUU7UUFDVixPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFrQixFQUFFLEdBQUcsQ0FBQyxDQUFBO1FBQ3BDLE9BQU8sSUFBSSxDQUFBO0tBQ2Q7QUFFTCxDQUFDLENBQUE7QUF2QlksUUFBQSxzQkFBc0IsMEJBdUJsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERvY3VtZW50Q2xpZW50IH0gZnJvbSAnYXdzLXNkay9jbGllbnRzL2R5bmFtb2RiJztcbmNvbnN0IGRvY0NsaWVudCA9IG5ldyBEb2N1bWVudENsaWVudCh7IGFwaVZlcnNpb246ICcyMDEyLTA4LTEwJyB9KTtcbmltcG9ydCB7IFRvZG9zQnlZZWFyQW5kVGl0bGVJbnB1dCB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbmV4cG9ydCBjb25zdCBnZXRUb2Rvc0J5WWVhckFuZFRpdGxlID0gYXN5bmMgKGlucHV0OiBUb2Rvc0J5WWVhckFuZFRpdGxlSW5wdXQpID0+IHtcbiAgICBjb25zdCB7IHllYXIsIHRpdGxlIH0gPSBpbnB1dDtcbiAgICBjb25zdCBwYXJhbXM6IERvY3VtZW50Q2xpZW50LlF1ZXJ5SW5wdXQgPSB7XG4gICAgICAgIFRhYmxlTmFtZTogcHJvY2Vzcy5lbnYuVE9ET1NfVEFCTEUhLFxuICAgICAgICBJbmRleE5hbWU6IHByb2Nlc3MuZW52LlRPRE9TX1RJVExFX1lFQVJfSU5ERVghLFxuICAgICAgICBLZXlDb25kaXRpb25FeHByZXNzaW9uOiAnI3llYXIgPSA6eWVhciBhbmQgYmVnaW5zX3dpdGgoI3RpdGxlLCA6dGl0bGUpJyxcbiAgICAgICAgRXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzOiB7XG4gICAgICAgICAgICBcIiN0aXRsZVwiOiBcInRpdGxlXCIsXG4gICAgICAgICAgICBcIiN5ZWFyXCI6ICd5ZWFyJ1xuICAgICAgICB9LFxuICAgICAgICBFeHByZXNzaW9uQXR0cmlidXRlVmFsdWVzOiB7XG4gICAgICAgICAgICAnOnRpdGxlJzogdGl0bGUsXG4gICAgICAgICAgICAnOnllYXInOiB5ZWFyXG4gICAgICAgIH1cbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBJdGVtcyB9ID0gYXdhaXQgZG9jQ2xpZW50LnF1ZXJ5KHBhcmFtcykucHJvbWlzZSgpXG4gICAgICAgIHJldHVybiBJdGVtc1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZygnRHluYW1vREIgZXJyb3I6ICcsIGVycilcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbn0iXX0=